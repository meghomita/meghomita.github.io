---
layout: default1
---

<div class="blog-container">
  <div class="blog-main">
    <div class="posts">
      {% for post in site.posts %}
        {% if post.megacategory == "blog" %}
          {% assign post_year = post.date | date: "%Y" %}
          {% assign post_month = post.date | date: "%B" | downcase %}
          {% assign date_id = post_year | append: "-" | append: post_month %}
          {% assign tag_list = "" | split: "," %}
          {% if post.tags %}
            {% for tag in post.tags %}
              {% assign tag_slug = tag | slugify %}
              {% assign tag_id = "tag-" | append: tag_slug %}
              {% assign tag_list = tag_list | push: tag_id %}
            {% endfor %}
          {% endif %}
          <article class="post" data-date="{{ date_id }}" data-tags="{{ tag_list | join: ' ' }}">

            <h1><a href="{{ site.baseurl }}{{ post.url }}">{{ post.title }}</a></h1>

            <div class="entry">
              {{ post.excerpt }}
            </div>

            <a href="{{ site.baseurl }}{{ post.url }}" class="read-more">Read More</a>
          </article>
        {% endif %}
      {% endfor %}
    </div>
  </div>

  <div class="blog-sidebar">
    <div class="sidebar-section">
      <h3>Archive by Date</h3>
      <div class="filter-controls">
        <a href="{{ site.baseurl }}/blog" class="clear-filter">Show All Posts</a>
      </div>
      <ul class="date-list">
        {% assign blog_posts = site.posts | where: "megacategory", "blog" %}
        {% assign posts_by_year = blog_posts | group_by_exp: "post", "post.date | date: '%Y'" %}
        {% for year in posts_by_year %}
          <li>
            <strong>{{ year.name }}</strong>
            <ul>
              {% assign posts_by_month = year.items | group_by_exp: "post", "post.date | date: '%B'" %}
              {% for month in posts_by_month %}
                <li>
                  <a href="#{{ year.name }}-{{ month.name | downcase }}">{{ month.name }}</a>
                  <span class="post-count">({{ month.items.size }})</span>
                </li>
              {% endfor %}
            </ul>
          </li>
        {% endfor %}
      </ul>
    </div>

    <div class="sidebar-section">
      <h3>Tags</h3>
      <ul class="tag-list">
        {% assign blog_posts = site.posts | where: "megacategory", "blog" %}
        {% assign all_tags = "" | split: "," %}
        {% for post in blog_posts %}
          {% if post.tags %}
            {% for tag in post.tags %}
              {% unless all_tags contains tag %}
                {% assign all_tags = all_tags | push: tag %}
              {% endunless %}
            {% endfor %}
          {% endif %}
        {% endfor %}
        {% assign sorted_tags = all_tags | sort %}
        {% for tag in sorted_tags %}
          {% assign tag_posts = blog_posts | where_exp: "post", "post.tags contains tag" %}
          <li>
            <a href="#tag-{{ tag | slugify }}">{{ tag }}</a>
            <span class="post-count">({{ tag_posts.size }})</span>
          </li>
        {% endfor %}
      </ul>
    </div>
  </div>
</div>

<script>
(function() {
  function filterPosts() {
    var hash = window.location.hash.substring(1); // Remove the #
    var posts = document.querySelectorAll('.posts .post');
    var sidebarLinks = document.querySelectorAll('.date-list a, .tag-list a');
    
    // Remove active class from all links
    sidebarLinks.forEach(function(link) {
      link.classList.remove('active');
    });
    
    if (!hash) {
      // Show all posts if no hash
      posts.forEach(function(post) {
        post.style.display = '';
      });
      return;
    }
    
    // Mark active link
    sidebarLinks.forEach(function(link) {
      var linkHash = link.getAttribute('href').substring(1); // Remove the #
      if (linkHash === hash) {
        link.classList.add('active');
      }
    });
    
    // Filter posts based on hash
    posts.forEach(function(post) {
      var postDate = post.getAttribute('data-date');
      var postTags = post.getAttribute('data-tags') || '';
      var tagArray = postTags.split(' ').filter(function(t) { return t.length > 0; });
      
      var shouldShow = false;
      
      // Check if hash matches date
      if (hash === postDate) {
        shouldShow = true;
      }
      // Check if hash matches a tag
      else if (hash.startsWith('tag-')) {
        if (tagArray.indexOf(hash) !== -1) {
          shouldShow = true;
        }
      }
      
      post.style.display = shouldShow ? '' : 'none';
    });
  }
  
  // Filter on page load
  filterPosts();
  
  // Filter when hash changes
  window.addEventListener('hashchange', filterPosts);
})();
</script>